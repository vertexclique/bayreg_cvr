function [Y,Xf,Af] = bayesian_regularization_conv(X,~,~)
%bayesian_regularization_conv neural network simulation function.
%
% [Y] = bayesian_regularization_conv(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [2;87;0;0;0;0;0;0;0;0];
x1_step1.gain = [0.0178571428571429;6.55326031253809e-07;0.00475059382422803;0.00312524416897877;2;2;2;2;2;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.02159372677776340288;0.017641065843896654858;-0.019032701567117664421;0.020633719977186316258;-0.021363614636577411832;0.018765155285206915753;-0.022026455062447294203;0.022305625095040512718;0.019294879865026200866;-0.5128709471155706856;0.020823928868340363385;-0.021376855082104857797;-0.014162405169120770645;0.020652413687775657281;-0.024550985767712325131;0.020439894210250702383;-0.11313483278944368171;0.018473936301547554117;-0.00054283274061041927438;-0.019928676820570506711;-0.44024012610802476519;-0.96472161200735706554;-0.018979655978561930929;0.018363798640051255673;0.020983188147292369113;0.50169773592943545104;-0.020680404154355673529;-0.59289202294888321276;-0.020535663162287144667;0.36217501603481144778;-0.021395878216459416482;-0.021421491680006562314;0.38566902767533750573;0.018723451084032002173;-0.21315935653891621149;-0.43751735272645048136;-0.022084869250772271032;-0.020509931724679953541;-0.020525852890681591661;-0.020478216326058760327;0.011719103761582954498;-0.023740967384544182928;-0.017755469100422416329;-0.021111685521676849114;0.017255937174608888818;-0.020902840080307596299;0.019979875486503973631;-0.30592106118778167323;-0.029769865905823995195;0.21515055746962008509;0.52079596013366935559;0.021282365510915796786;0.40063069736805767551;0.30999621529655640995;-0.013548229004832320482;-0.16602205123614649507;1.3106485764195094923;0.24326011921307280628;-0.02202109478975068993;0.016285911809375937936;-0.018673002648136465681;0.84637827673190690891;-0.019898075493535071628;-0.020483984876974423855;0.01908034305253025753;0.019693965963256392093;0.008960381799426915192;0.05662831414232586541;0.021376504887553000878;0.43090103178564692632;-0.020093206439335133118;0.02012102064566518092;0.021218965540523045815;0.26953912008031405412;0.020522044471635761398;0.16471094102488753608;0.022105146881302870088;0.020985075450297076272;0.021105647791765807381;-0.020785200889424711168;0.020141581980134069807;0.02014147202883331822;-0.019571562541714299099;0.010559757057962417329;-0.020398683834883277882;0.020975711286857965515;-0.022575762119211903456;-0.021196512388530892174;-0.021263914177121742699;0.019099537828968421449;0.13811402353947721533;0.018930180327335548868;0.018039852706032387386;-0.017954505148590326619;0.59908528825790618999;-0.020587976635990441754;-0.017384788913439717939;0.017164806839156311613;0.50026587885553652768;-0.020737133527079731898];
IW1_1 = [0.019604505124491539841 -0.022301341640851367332 0.084591214706150094638 0.12781084092863850832 -0.00047556494033071773989 0.00047556494033377622 0.0096431424472085414124 -0.015574481009120226538 0.024706699803193923198 -0.061962814798579873843;0.019915433406832831059 -0.016838022989516789052 0.078375711492273111847 0.11579663333577798479 -0.00073702402634214588158 0.00073702402634151942956 0.012349738744164964754 -0.013119384179829104292 0.02093814816906963 -0.055450634417543019639;-0.019869450896615209468 0.018755893966595656858 -0.080672213827966771094 -0.12015728533603207973 0.00064656341870849025257 -0.00064656341870948782699 -0.011485519831062435472 0.014031594179067199968 -0.022262005507803182824 0.057781334290352433236;0.019733790293531366933 -0.020973927695173599089 0.083160703433744348478 0.12498674492048328366 -0.00053665901614858570971 0.00053665901614801639515 0.010370096882210412884 -0.01502215646748386417 0.023790531943933147102 -0.060405912310767195805;-0.019638770289960326421 0.021983515874318050598 -0.084251874023731770924 -0.12713804715431473169 0.00048988491792399777199 -0.00048988491792364193683 -0.0098213315727949546813 0.015445063694379488131 -0.024487100918129528493 0.061590598071355757981;0.019883096609008776845 -0.018385865026147359819 0.080241397654997770328 0.11933225731518472268 -0.00066492776053165268159 0.00066492776051969989474 0.011659618121048388392 -0.013859099470447082056 0.022006888613021607926 -0.057337717834853439702;-0.019534989261419659357 0.022898544871012904006 -0.085223985232252094657 -0.12906939188826987985 0.00044854193906848215546 -0.00044854193906676282765 -0.0093011838829867091172 0.015813320120892582904 -0.025119961861747655552 0.062660735744974008221;0.019487112394384661224 -0.023283701108894598597 0.085628843546431118727 0.12987676375871237688 -0.00043044177410338213801 0.00043044177409730561851 0.0090756757180246103167 -0.015964837956622325577 0.025387062388449323225 -0.06310915035406133855;0.01985370754058375653 -0.019118859755799379879 0.081089896739524436331 0.12096027010913200372 -0.00062837236859522170758 0.00062837236859368344154 0.011311400487170657214 -0.014198959453710930517 0.022512173910505080959 -0.058214374668995851059;-1.2076151443395615193 -0.9662656099326546455 -1.6862904875833635288 -0.57702135283613131822 0.45889322466086168717 -0.45889322466085702423 0.090918479929539497419 -0.020903416551701883147 0.76661273080552638781 0.18911410005311307669;0.019711075513121661257 -0.021237232992089755818 0.083447364496726253447 0.1255500191687188849 -0.00052421242726802708568 0.00052421242726640576975 0.01022948597637901233 -0.015134218061502530128 0.023972090334404110024 -0.060715215991946513974;-0.019636852874969263488 0.022001809149714585123 -0.084271456416578585658 -0.1271768269823561337 0.00048905776928356685124 -0.00048905776928304220581 -0.0098111465844049096374 0.015452559341101687954 -0.02449973535127771343 0.061612032754173262639;-0.01977410941660660143 0.012194734185065288223 -0.071846412753639551929 -0.1038945213428513481 0.00084460394471759969899 -0.00084460394474014503265 -0.013992159991946695463 0.010765312591395011926 -0.017685325605331075199 0.049236983347195506511;0.019731622180544097778 -0.02099981106266062339 0.083188952254703615874 0.12504219036990210645 -0.00053542720686471296284 0.00053542720686240252801 0.010356352485171247887 -0.015033227507981632154 0.0238083769023127792 -0.060436329260932730723;-0.019143472431913322734 0.026441428397502370756 -0.088828091499846842383 -0.1361892786568894842 0.00011555411868900439688 -0.00011555411868907920683 -0.0070920512179659146723 0.017265127348859505424 -0.027615549082492356348 0.066544444485147583035;0.01975544687214929665 -0.02070549073436213014 0.082866805266203449887 0.12441070996114012015 -0.00054953830637988361745 0.00054953830638045650988 0.010511642450092527346 -0.014906634189764234044 0.023605488721599926505 -0.060090285395814790892;-0.37042619817823402295 -1.8868320660816408907 0.24310949149342622744 0.05802881966193395441 -0.25574223016443242695 0.25574223016406399944 -0.59220594424093120356 0.54597680380594570959 -0.1471259676367852598 0.41962477363697786581;0.019895266573449761627 -0.017983661158861821011 0.079766948877101132021 0.11842741964280029121 -0.00068453779820226766471 0.0006845377981985936288 0.011844917218687422283 -0.013669587656985627763 0.021729462257967329525 -0.056852664420807344503;-0.0022788186589470949689 0.00011277832190608015758 -0.0058139306215439058925 -0.0077228792262390311835 2.8144377088048456374e-05 -2.8144377087992711442e-05 -0.0018032432489271097743 0.00050788521452789752841 -0.0011693996687645066661 0.0035504231829761555284;-0.019805457370921129151 0.019997092720540416561 -0.082082458478110215117 -0.12288078303309304951 0.00058432704422790545436 -0.00058432704422841036732 -0.010876486164006760743 0.014595751091865415139 -0.023117322681657816175 0.059255411392626036737;1.5171211265539668034 -0.72991446950833382967 -1.5599295179294832003 -0.54604711997146215818 0.25684384384128694512 -0.25684384384118119637 -0.81342840856352649492 0.25943577933435613136 0.06021013926766205504 1.3742627421897306572;-0.90996584401140290232 0.095433964386566622062 -0.23362587979843429942 -1.9130169762298723235 0.1888448423229810158 -0.18884484232203929688 0.34890952264149965867 0.20869212875803741514 0.95659735351809471737 0.41524421911810044383;-0.019872348037400140025 0.018682496069657175686 -0.080587171729309556301 -0.11999416936859970406 0.00065022450023058397939 -0.00065022450023003645729 -0.011520327896838215148 0.013997525481473108155 -0.022211408592339665358 0.057693522966097039728;0.019899159986912037801 -0.017831734825319855986 0.079585958887986404942 0.11808327880688201938 -0.00069181829257272241945 0.00069181829257351269442 0.0119138341782850498 -0.013597482267494860608 0.021624626429319723092 -0.056668575619823094436;0.019690940829858248617 -0.021457587188240350579 0.083686096778734495039 0.12602016769879714753 -0.00051393886355028111246 0.00051393886354947424921 0.010110456366207130896 -0.015227039670158478563 0.024124083342764883475 -0.060973876327783331497;-1.9243458697275110936 -0.24543402642655806623 1.181249444871325105 0.012196694627243738832 -0.054011325239146847077 0.054011325239142003729 0.0083350383431356409036 -0.11509955032222363158 -0.30208185114449653819 -0.59454910872794752841;-0.01972834963799739369 0.021038564486606514681 -0.083231218571088172453 -0.12512517413429333213 0.00053358626460488689427 -0.00053358626460474605641 -0.010335742217773728063 0.015049780990312030746 -0.023835095932046239386 0.060481865469046144912;1.3527675232416676021 -0.58535585959361224884 -3.5201040328727275508 -1.4111117763993472618 -0.15200681383815622949 0.15200681383804445779 0.066089255754701911605 -0.17314773729649696188 0.56563845829511205654 0.72720406914789337272;-0.019744933873885477105 0.020838139167310976152 -0.083012249650857780625 -0.12469559197859776678 0.00054315052601862812576 -0.0005431505260197625265 -0.010441924804668614724 0.014963879757255809516 -0.023696922188997431025 0.060246293560117736288;0.91941438747768644557 0.4878928417397001005 0.52287586541050024014 1.1186503036603177019 -0.04370168977165593549 0.043701689775921016834 -0.038713672911493940409 -0.91766238225512086757 -0.15441782473858514657 0.38644384784234442343;-0.019634086305397341343 0.022028090611328425552 -0.084299578898609783817 -0.12723252905085263853 0.0004878702461492096876 -0.00048787024614903068583 -0.0097964989035004158141 0.01546331802368856867 -0.02451788794135744548 0.061642825255148220309;-0.019630339509644614826 0.022063474564345972317 -0.084337421081485702823 -0.12730750121950182296 0.00048627286449331856046 -0.00048627286449378249057 -0.0097767497604547368845 0.015477784124305614052 -0.024542329568733704109 0.061684278560568274463;-1.1508222523849684915 -0.15316058409716526434 -0.32279788920298474464 0.043862294246891211924 -0.22611640981908756598 0.22611640981968397779 -0.093395714728714926411 -0.97118339759482275042 0.13043352240421612898 0.16280753456911775667;0.019885008785342855875 -0.01832822755340630938 0.080173812723644141687 0.11920312418974116087 -0.00066776388805157513035 0.00066776388805100755051 0.011686424969530167031 -0.013832067717180913588 0.021967141207535144376 -0.057268400629561559689;-1.5639195793311986282 -0.31873875042734189922 -0.038664906832213831456 0.069748562824475487942 -0.60266715002604975826 0.60266715002605097951 0.56621729453458713444 -0.01762067727087342911 -0.47527940614885116899 0.35300150195403340314;-0.15599775185998365767 0.18327624638528716705 -1.9693209761549579362 -0.10459366388264841607 0.12947905387082431217 -0.12947905387033470381 -0.086999229576543046782 -0.30250688375108536476 0.31106528518877779588 0.95347553357934511364;-0.019525146693379534513 0.022979134346737151162 -0.085308904950526426303 -0.12923862653276291246 0.00044482372253636299521 -0.00044482372253657923933 -0.0092543215511262828799 0.015845165341002311055 -0.02517580705312249742 0.062754701765286122206;-0.019747794451383068881 0.02080250145589214103 -0.082973215783015974445 -0.12461910035827369891 0.00054486224654032181045 -0.00054486224653977634834 -0.010460698922332867244 0.014948530626847244054 -0.023672356357942955091 0.060204388102275255279;-0.019746027602774000181 0.020824552305205915742 -0.082997371581938803042 -0.12466643348393648127 0.00054380272922315161209 -0.0005438027292213197441 -0.010449086206695577111 0.014958030567614117798 -0.023687556380844822929 0.060230317809534340834;-0.019751283932487467138 0.020758573362885467117 -0.082925059551128180169 -0.12452476867935410865 0.00054697667615851927343 -0.00054697667615788512357 -0.010483796384501012713 0.014929579836427037121 -0.023642076875780081852 0.060152726078034436663;0.019385752660791195218 -0.0091500572483914407312 0.066246570396391396551 0.09426011060006882214 -0.00078523513065093951575 0.00078523513064936113423 0.014573074710527390493 -0.0091076946693812964317 0.015440875085352833915 -0.044344462653386484963;-0.0192345729098424012 0.025277593895057709483 -0.087680148523987352926 -0.13396111856490111602 0.00029212679678997240888 -0.00029212679678785490782 -0.007847848487442712212 0.016749693146212222411 -0.026782870768912281356 0.065362960879534012792;-0.019913905920442981357 0.016994892967699945507 -0.078570001536245992479 -0.11616202309811995974 0.00073021591217967954292 -0.00073021591217879927918 -0.012282666385956620206 0.013195566480945162754 -0.021046622818179309966 0.055644660924261679646;-0.019673956985928910818 0.021635301274226709928 -0.083877892355143507386 -0.12639855725960363886 0.00050574337360868176511 -0.00050574337361061511443 -0.010013555443836729894 0.015301262518016256128 -0.024246705430534507691 0.061182369402364787658;0.019917754232046894908 -0.01631133364865071031 0.07771366418865170711 0.11455643574253798755 -0.00075878266923861239016 0.00075878266923835847001 0.012570023067817742354 -0.012861803251494843825 0.020573580532571762031 -0.054793674705778762368;-0.019701225962895339144 0.021346428979581718449 -0.083565797242887859819 -0.12578313723788292489 0.00051910541696902220109 -0.00051910541696855816256 -0.01017065596343411267 0.015180325057917344253 -0.024047403645423688634 0.060843414713011502448;0.019800905701187570401 -0.020068052892552378647 0.082161637376301333013 0.12303473621483372591 -0.00058079909728774384032 0.00058079909728938738239 0.01084050561478522301 -0.014627275328828666032 0.023166216329899826099 -0.05933919758322708099;1.1272748710267155303 -0.84845306094215966475 -1.6458550833667477953 -2.667065014211859264 -0.45795657229374209241 0.45795657229386432796 0.14761378070357078496 -0.22994751242911984357 0.043046084871662039506 0.65112976923239362925;-0.024032933018473572745 0.037038088195716245554 -0.097413920750102356294 -0.14751516310889600803 -0.0079191914363135711141 0.0079191914363130940652 -0.0002950675112786769333 0.027548860967563166408 -0.036698130893062994029 0.068984069241893944402;-2.3256882772121025837 1.1216020726969049282 0.37999820781484239252 0.43037539581904932229 0.79967370145973259987 -0.79967370145968752482 0.21830193007447301623 -0.12404741985213879607 -0.40103555731468520928 -0.12352006785506540465;1.0415620290157536765 0.84929890670434304845 0.40743059957501293056 1.0288991494230359525 0.63371117559415501841 -0.6337111755941584601 -0.11816269911632322487 0.26145792479763874105 -0.60174388283905100305 -0.58314326310026931566;0.019650388596741025921 -0.02187124399734462904 0.084131551304404278424 0.12689989314791788599 -0.00049497291622494377777 0.00049497291622385773246 0.0098836505055377738699 -0.015398932729958405077 0.024409571649926811721 -0.061459020449502431427;-0.79024894363745035175 2.1671479835267590808 1.0669699044443294866 2.1681310225177692352 0.27025548756526940331 -0.2702554875652967703 -0.2188669085902597844 -0.4613230286096505206 0.49420237243156223128 -0.61527382996543211746;0.53958367186536104754 -1.1859864351099811408 -2.2352109987292112514 -2.5081901306520375527 0.53144184321855969522 -0.53144184321859555542 0.39128049951102417126 -1.4034748184105985125 0.91098445615574374923 -0.51878256784845655503;-0.019705300868964732014 0.011409230155373905821 -0.070535872125939647059 -0.10159347163542215009 0.0008399508615178597707 -0.00083995086151846865864 -0.0141897430486330519 0.010348364244997449932 -0.017119801249518600689 0.048057638065117945503;-1.0496688709404193851 -3.7752440278322341172 -0.46391160038908291208 0.67167218184204080522 -0.061639837684480690283 0.06163983768436703814 -0.58274927429444811633 0.88324242599890900873 -0.35755513351497308916 0.38910608428023119032;-1.3735752966720509161 0.14265430053149699696 1.1003226146435385324 0.92269539672370870509 -0.3858648137290627278 0.38586481372851078042 -0.41079041979272273855 -0.40703657510190505153 -1.2742394355384589755 -0.52923072243364299716;1.3285208802682961782 0.74218049257940998942 -0.69840098692913876732 -1.1134639540284270165 -0.089314264523053701894 0.089314264524015682389 -0.27059659788435497241 0.022401686791243637098 -0.39045018321522623195 0.15212485592300137305;-0.019535887426124255717 0.022891149586962422635 -0.08521618707054107178 -0.12905385452342438279 0.00044888175720828992626 -0.00044888175720957687424 -0.0093054756465501316937 0.015810393708777445432 -0.025114838277936375743 0.062652109794909260909;0.019904588672910821651 -0.014996213141845557426 0.075986905122671866142 0.1113571646993023051 -0.00080414007895858799491 0.00080414007895978430358 0.013085431768288881965 -0.012207500882192197367 0.01965999393526280184 -0.053109748439050592783;-0.019887245606886184979 0.018258521781721725324 -0.080091898582134279927 -0.11904671936120871101 0.00067118325846329503822 -0.00067118325846448289012 -0.011718732058662193959 0.013799318789223854326 -0.021919067638404794718 0.057184486210047208443;0.0064482393609176834673 0.30348406793023913197 1.5529460025655057454 0.38133534413223335591 -0.48818392400836274625 0.48818392400820476151 -0.38138664744578792964 -0.65478438669999272648 -0.21392374333256095054 -0.44266177597197781113;-0.019808130154114620552 0.019954679679654772906 -0.082035064580007241442 -0.12278868465212441907 0.00058643928230038815802 -0.00058643928230128804582 -0.010897931809138434664 0.01457686935022839414 -0.023088099109095205907 0.059205312548334783351;-0.019750652230867943304 0.020766563432077812801 -0.082933822141516969073 -0.12454193043568428934 0.00054659171526295620251 -0.00054659171526264308492 -0.010479598811480757281 0.014933029333197280972 -0.023647584314260016586 0.06016212354712927729;0.019866767007620002305 -0.018821826807068810922 0.080748437092311220464 0.1203035940183808522 -0.00064326857982139598255 0.00064326857982171256958 0.011454136530864850521 -0.014062134443933433856 0.022307453659644819327 -0.057860141849443220974;0.019825053120787698019 -0.019671793305994875189 0.081717608256778873077 0.12217280970253718841 -0.00060058404753668794603 0.00060058404753719285898 0.011039822247914070699 -0.014450185436324409702 0.022893185344419565708 -0.058870754082305430666;0.018395376641868476514 -0.0060165351518304509282 0.058292804010725632335 0.081379887425756497477 -0.00061429881142958670925 0.00061429881142956307364 0.014417334696902985372 -0.0072168568229592335375 0.012859536745682980177 -0.037980778217779009864;-1.1054911004847296496 -1.3198743517246112056 -2.588084968897948368 -1.017918508687649215 -0.017825881268500567284 0.01782588126849237592 -0.80417576905091014972 0.24913678445761203162 -0.082270354007397988871 0.52405271031566480477;0.019636903675732675367 -0.02200132532204850111 0.084270938574627154982 0.12717580140243422981 -0.0004890796384608567856 0.00048907963846212606108 0.0098114160720626647505 -0.015452361172021724517 0.02449940118273545922 -0.061611465854022814947;1.3714442581839918489 -1.7196968797355518532 -0.8761314868889282792 -0.01299230263905406732 0.44533144248845712987 -0.44533144248825762279 -1.0856773172389981852 -0.48040172347592752233 0.81933896757274826683 -0.11506199043611728405;-0.019790472351532490541 0.020225121494889329588 -0.082336397400542979397 -0.12337492608516954784 0.00057301964481149404544 -0.0005730196448115340525 -0.010760416281240114608 0.014696755115084884913 -0.023274444124126460881 0.059524518171354810769;0.019787835910398489381 -0.020263668180238635086 0.082379182418850685488 0.12345829390890968036 -0.00057111727296375305526 0.00057111727296304192706 0.01074066707851072458 -0.014713742938146479045 0.02330100545663267575 -0.059569970892013185404;0.019659276599852337775 -0.02178361666425487897 0.084037471956831616415 0.12671383609045325236 -0.00049895961369051777378 0.00049895961369088922144 0.0099320636498772645051 -0.015362774079619832476 0.024349074759354737141 -0.061356295409506905747;-1.2650179481861250075 0.24940803220283111474 0.40087420907703791295 0.83044394626014506056 -0.15491201115108968467 0.15491201115024449964 -0.14057666275951863355 0.7848894095744338717 -1.1087791326010159043 -0.074611854382485590098;0.019746451159649767298 -0.020819277705694406305 0.082991594532347154334 0.12465511247391115879 -0.00054405605196227607191 0.00054405605196288083988 0.010451865103591261724 -0.014955758951407006549 0.023683920485420759811 -0.060224115582185148987;-0.48834605581650053496 -0.90503577431959425503 0.44811908808316258668 1.395441202702466299 0.22245980562322381635 -0.22245980562320871732 -1.0450838762740188859 -0.18262784324112923962 0.19147622015756030067 0.70681361731140746052;0.019521707032833433143 -0.023007109406075334362 0.085338357440030515599 0.12929733717058544684 -0.00044352597513623294402 0.00044352597513624861074 0.0092380142799031207679 -0.015856200945386169504 0.025195197594813947134 -0.062787304690003237218;0.019690696136554382972 -0.021460197880663875458 0.083688919040836903807 0.12602573134719499692 -0.00051381790107912740043 0.00051381790107889570643 0.010109038708035573625 -0.015228134141733316864 0.024125884428022638384 -0.06097693989521353608;0.019674769696487012099 -0.021626952587900840491 0.083868896549381316552 0.12638079639376290086 -0.00050612668517668922899 0.00050612668517600097745 0.010018125810451972146 -0.015297788352063818734 0.024240943960232602672 -0.061172577004301342818;-0.0197158180992146638 0.021183632911914052066 -0.083389135516284837446 -0.12543548972781531914 0.00052673095199325299393 -0.00052673095199252375955 -0.010258252287792162319 0.015111507228675026548 -0.023935126237218919132 0.060652273075551571546;0.019785867644550592104 -0.020292162782468401577 0.082410784319075724991 0.12351989179755723525 -0.00056971283964173493383 0.00056971283964227801069 0.010726044118868037491 -0.014726284532114273726 0.023320640455472108066 -0.059603564001841045916;0.019785878212553266453 -0.020292010406932393246 0.08241061538500266126 0.12351956246893038005 -0.00056972034490819273202 0.00056972034490854726613 0.010726122369442191509 -0.014726217504879042866 0.023320535454045047963 -0.059603384375212495327;-0.019834457373325155294 0.019502167016888911216 -0.081526087938373889563 -0.12180211578983632381 0.00060909978330791363955 -0.00060909978330723221849 -0.011123946677973190617 0.014373612671431609117 -0.022776307482475915966 0.058669766576206913711;0.019063512236131122807 -0.0077888855763908514465 0.063160573561590785396 0.089160011102292380247 -0.00072356649439542838204 0.00072356649439497789603 0.014630515650999860108 -0.0083186022396504657322 0.014370271100602535416 -0.041801698623938662869;-0.019759858430950422853 0.020648403031209548036 -0.082804078664880487182 -0.12428796060169505777 0.0005523010710548695041 -0.00055230107105525819058 -0.010541510335768122103 0.014881901871114096986 -0.023566141728411035133 0.06002311786743155797;0.019691908813210798335 -0.02144724440670552762 0.083674914396362445879 0.12599812462838236304 -0.00051441824144565122603 0.00051441824144430746586 0.010116070996833682882 -0.015222702480234924158 0.024116948040847376727 -0.060961739133732852081;-0.019439101982775739558 0.023656570735462182503 -0.086018377730853981533 -0.13065450055013355657 0.00041172999779358056228 -0.00041172999779371408178 -0.0088536540490733884462 0.01611022998535988765 -0.025646202620586290577 0.063541150927296854989;-0.01966238660889888662 0.021752579172779416827 -0.084004113265986765646 -0.12664789679822410773 0.00050037532728391042811 -0.00050037532728339001106 -0.009949164027259945961 0.015349934150882147896 -0.024327649640791745855 0.061319904296255417497;-0.019652991445062835407 0.021845743561018472062 -0.084104188629335843719 -0.12684576500380098651 0.00049613158296179604798 -0.00049613158296017841834 -0.0098977596633770120738 0.015388424174327315977 -0.024391965210913548606 0.061429129055319636743;0.019865663651608828077 -0.018848394344017384977 0.080779106295212579902 0.12036249156756967382 -0.00064193946073277138691 0.00064193946073313069151 0.011441459824533284709 -0.014074423485080166107 0.022325766234634523977 -0.057891878233990529123;-1.7064655574079763412 0.4968037929938300401 -0.063779825343589960363 2.22946950086438056 -0.35466968490231276512 0.35466968490237049672 0.22106599606235641242 -0.62993967664777705817 0.86881490310700926205 -0.73616926960228667998;0.019874964164621929108 -0.018614051795906087078 0.080507687533825797455 0.11984182838215151623 -0.0006536312044576235783 0.00065363120445781407262 0.011552664602749299072 -0.013965689792649896989 0.02216422339675524697 -0.057611558860001362004;0.019908416480652817854 -0.01738557485533289565 0.079048460811413229221 0.11706460627303759414 -0.0007126896107918172631 0.00071268961079135560981 0.012112766253083094917 -0.013384169690059883814 0.021316592941218757973 -0.056124894911073294756;-0.019910319574932808934 0.017268221160433746414 -0.078905531744965742846 -0.1167945660532855312 0.00071803465979733351217 -0.00071803465979739552853 -0.012164226379981603679 0.013327689552847707052 -0.02123552459611412202 0.055981071724177898508;-0.23687248604494537396 0.0066391828068306313684 -0.82878097582040322067 2.400108499875967194 0.30144592096133271397 -0.3014459209585919619 -0.6599823281883832049 -0.28646737159463853128 -0.16448770785232039171 -0.087233168896328594499;-0.019739036619252883081 0.020910586407808264692 -0.083091507968082470303 -0.12485098913156711387 0.00053968103561956304315 -0.00053968103561882068992 -0.010403660432164060085 0.014995013071971348764 -0.023746864188581691402 0.060331464821648479735;-0.019917458831234090971 0.016487294474951147416 -0.077936563329778066334 -0.11497314619187665174 0.0007517127103403456554 -0.00075171271034002689997 -0.012497279311564267468 0.012948159211415899428 -0.020695445725193960251 0.055014143651010365133;0.019917672972443001972 -0.016187048227770749198 0.077555146699990043513 0.11426060624527056842 -0.00076364765627141438422 0.00076364765627144203138 0.012620881875050456167 -0.012800631102488201768 0.020487459541623200682 -0.054637323995196968029;0.76718517305027422726 4.1915631340064480881 0.42909914042086416686 0.68644987269049562162 -0.15034998851567571432 0.15034998851553191268 0.3411234641025470693 -0.98844298489162052412 0.1736531003713901733 -0.52686533729671969351;-0.019721620674399569645 0.021117099051982151509 -0.083316767428723112476 -0.12529322996006350688 0.0005298679911983096829 -0.0005298679911987001041 -0.01029385839022655888 0.015083244242896139825 -0.023889246309401264423 0.060574127515514143705];

% Layer 2
b2 = -0.060791413452756043467;
LW2_1 = [-0.18461341676868434081 -0.1666150070478584766 0.17315248635872121374 -0.18038910115558970393 0.18360767696959648387 -0.17191547397660744689 0.18649379623083339741 -0.1876995323168559604 -0.17435635879472707876 1.2870280141531060814 -0.18123220092211478338 0.18366565855584793265 0.14882633628826685834 -0.18047210235878607953 0.197158671830660992 -0.17952664336348006513 -1.4230435296460930417 -0.17055878235682442323 0.010793384023462243917 0.17723488243058302394 1.3918194115384983078 1.4318306331522498986 0.17290792206049629409 -0.17004280115848774413 -0.18193570922422297453 0.78528021686574711602 0.18059632355638424728 1.8168490116695406034 0.17995320916790208399 1.6014434676095039567 0.18374893906744227401 0.18386102611271079588 -1.5310586757449362594 -0.17172185379030041608 -0.86825027633639451086 -1.7088417842786274292 0.1867465613795888657 0.17983868099206262725 0.17990955171671377255 0.17969743549610975308 -0.13453002544685696562 0.19380355506360374962 0.16716263870215647414 0.18250177497193673104 -0.16475666981708117498 0.18158105146711475686 -0.17746556128686824527 -2.5198518760234285274 0.21674641845945497032 -0.99875039807710763728 -0.79514085369250320223 -0.1832515722759315846 -1.7013751308407707441 -1.6746774558224801766 0.14540238263978019773 2.2509380772841973695 1.3478747230039960225 -2.0880264346504473494 0.18647058908807115363 -0.15996682292334291065 0.17148734273257901228 1.5270156357481452503 0.17709687895278766745 0.17972313277151291677 -0.17337184794105167662 -0.17617392319276331536 -0.11559178024097245541 1.5794337886099578672 -0.18366412517977112606 -1.9403587507516171229 0.17797524472067410839 -0.17810013876777930353 -0.1829733315951148076 -1.6792409967485510958 -0.1798926012054732626 -1.5432404738314835502 -0.18683424633350531607 -0.18194403327829239414 -0.18247520775949024885 0.18106079612848435811 -0.17819241638201860356 -0.17819192303336864325 0.17561831767361643641 -0.12700638361156468825 0.1793428272745412333 -0.18190272923078484868 0.18886079649815601389 0.18287471471848221194 0.18317062903216888015 -0.17346015250476423675 -1.4050971675844832198 -0.17267951022266428418 -0.16851558814685066445 0.16811077880748809266 2.0211752733292800421 0.18018586609475895077 0.16538099799152744529 -0.16431350275842795949 3.0282802250352185425 0.18084787502657140301];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0333333333333333;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
